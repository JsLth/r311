<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>r311: An R interface to the open311 standard • r311</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/Roboto-0.4.9/font.css" rel="stylesheet">
<link href="../deps/JetBrains_Mono-0.4.9/font.css" rel="stylesheet">
<link href="../deps/Roboto_Slab-0.4.9/font.css" rel="stylesheet">
<link href="../deps/font-awesome-6.4.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.4.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="r311: An R interface to the open311 standard">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">r311</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.3.5</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../index.html"><span class="fa fa-home"></span> Overview</a></li>
<li class="active nav-item"><a class="nav-link" href="../articles/r311.html"><span class="fa fa-book"></span> Get started</a></li>
<li class="nav-item"><a class="nav-link" href="../reference/index.html"><span class="fa fa-search"></span> Reference</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/JsLth/r311/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>r311: An R interface to the open311 standard</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/JsLth/r311/blob/main/vignettes/r311.Rmd" class="external-link"><code>vignettes/r311.Rmd</code></a></small>
      <div class="d-none name"><code>r311.Rmd</code></div>
    </div>

    
    
<div class="section level2">
<h2 id="introduction">Introduction<a class="anchor" aria-label="anchor" href="#introduction"></a>
</h2>
<p>open311 is an international open-access standard for civic issue
management and public service communication. The standard allows
administrations to better manage citizen requests, citizens to more
easily participate in administrative work, and researchers and data
scientists to access data regarding public service communication. As an
open standard, open311 is not a centralized API, but a framework
implemented by various cities (e.g. San Francisco, CA, Chicago, IL,
Cologne, DE, Turku, FI, Zurich, CH) and services (e.g. SeeClickFix,
FixMyStreet).</p>
<p>It is way past the golden age of open311 APIs and much of development
in civic issue tracking has shifted to less open-access and less
standardized alternatives. Many former prime examples have abandoned or
severely limited their open311 endpoints. Nonetheless, open311 still
constitutes a valuable source for open government data. Many cities and
services still maintain an open311 service.</p>
<p><code>r311</code> allows the seamless management and selection of
endpoints and retrieval of service and request data. It supports (but
does not depend on) many popular R frameworks such as the tidyverse,
<code>sf</code> and <code>xml2</code> for response formatting.
<code>r311</code> is designed to be slim, both in content and
dependencies. It imports only two import-less packages used for HTTP
response handling. The functionality is limited to two main
features:</p>
<ul>
<li>Endpoint management</li>
<li>Sending requests</li>
</ul>
<p>This vignette will briefly cover these two features.</p>
</div>
<div class="section level2">
<h2 id="endpoints">Endpoints<a class="anchor" aria-label="anchor" href="#endpoints"></a>
</h2>
<p>Since open311 is an open and decentralized standard, there is not one
but many endpoints that one can access. An endpoint is commonly
implemented by a city administration, but can also be managed by a
service provider such as FixMyStreet. Each endpoint can define multiple
jurisdiction IDs, although, in practice, most endpoints only define a
single jurisdiction.</p>
<p>It can thus be difficult to manage the multitude of endpoints and
jurisdictions. Efforts have been made to list open311 servers, but most
of them are incomplete or outdated. <code>r311</code> offers an updated
and modifiable endpoint list that defines a number of open311
implementations that are defined for use in the package. The list can be
read using <code>o311_endpoints</code>.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/o311_endpoints.html">o311_endpoints</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 66 × 9</span></span></span>
<span><span class="co">#&gt;    name            root  docs  jurisdiction key   pagination limit json  dialect</span></span>
<span><span class="co">#&gt;    <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>           <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>        <span style="color: #949494; font-style: italic;">&lt;lgl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;lgl&gt;</span>      <span style="color: #949494; font-style: italic;">&lt;int&gt;</span> <span style="color: #949494; font-style: italic;">&lt;lgl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>  </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 1</span> Annaberg-Buchh… http… http… annberg-buc… FALSE TRUE          50 TRUE  Mark-a…</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 2</span> Bloomington, IN http… <span style="color: #BB0000;">NA</span>    bloomington… FALSE TRUE        <span style="text-decoration: underline;">1</span>000 TRUE  uReport</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 3</span> Bonn, DE        http… http… bonn.de      FALSE TRUE         100 TRUE  Mark-a…</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 4</span> Boston, MA      http… http… <span style="color: #BB0000;">NA</span>           FALSE TRUE          50 TRUE  Connec…</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 5</span> Brookline, MA   http… http… brooklinema… FALSE TRUE          50 TRUE  Connec…</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 6</span> Austin, TX      http… http… <span style="color: #BB0000;">NA</span>           FALSE TRUE          50 TRUE  Connec…</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 7</span> Chicago, IL     http… http… cityofchica… FALSE TRUE          50 TRUE  Connec…</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 8</span> Newport News, … http… http… cityofnewpo… FALSE TRUE          50 TRUE  Connec…</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 9</span> San Diego, CA   http… http… sandiego.gov FALSE TRUE          50 TRUE  Connec…</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">10</span> Köln / Cologne… http… <span style="color: #BB0000;">NA</span>    stadt-koeln… FALSE TRUE          50 TRUE  Mark-a…</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># ℹ 56 more rows</span></span></span></code></pre></div>
<p>The list does neither claim comprehensiveness nor up-to-dateness. It
arguably provides some of the most important and easily accessible
endpoints as of 2024. However, <code>r311</code> also offers the ability
to add new endpoints to <code>o311_endpoints</code> using
<code>o311_add_endpoint</code>. You need to provide a name (for lookup)
and a root URL (the URL used to send requests). The following code adds
the open311 test server of San Francisco.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/o311_endpoints.html">o311_add_endpoint</a></span><span class="op">(</span></span>
<span>  name <span class="op">=</span> <span class="st">"San Francisco Test"</span>,</span>
<span>  root <span class="op">=</span> <span class="st">"http://mobile311-dev.sfgov.org/open311/v2/"</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p>Retrieving the endpoints list again confirms that you successfully
added a new row to the endpoints dataframe.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="fu"><a href="../reference/o311_endpoints.html">o311_endpoints</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 67</span></span></code></pre></div>
<p>You can now select the San Francisco test API to the session using
<code>o311_api</code>. This function matches an API using endpoint name
and jurisdiction ID and attaches it to the active session. Query
functions automatically detect the attached API.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/o311_api.html">o311_api</a></span><span class="op">(</span><span class="st">"San Francisco Test"</span><span class="op">)</span></span></code></pre></div>
<p>After attaching an API, <code>o311_ok</code> confirms that the
selected endpoint is able to handle request queries.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/o311_ok.html">o311_ok</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] TRUE</span></span></code></pre></div>
<p>As the result is , you can safely start receiving real request
data.</p>
</div>
<div class="section level2">
<h2 id="making-requests">Making requests<a class="anchor" aria-label="anchor" href="#making-requests"></a>
</h2>
<p>After selecting an API and attaching it to the session, all functions
can access it. You can now make requests.</p>
<div class="section level3">
<h3 id="services">Services<a class="anchor" aria-label="anchor" href="#services"></a>
</h3>
<p>To get an overview of the available services in a jurisdiction, you
can use <code>o311_services</code>, which returns a list of San
Francisco’s administrative services.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/o311_services.html">o311_services</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 21 × 6</span></span></span>
<span><span class="co">#&gt;    service_code             service_name        description metadata type  group</span></span>
<span><span class="co">#&gt;    <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>                    <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>               <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>       <span style="color: #949494; font-style: italic;">&lt;lgl&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 1</span> 6050cd8ce8961bbfa32bcf2c Shared Spaces       Use this o… TRUE     batch Gene…</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 2</span> 55d6cb85df86af51c305616e Noise Issue         <span style="color: #BB0000;">NA</span>          TRUE     batch Gene…</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 3</span> 5fe20af6e896f754e2784e99 Holiday Tree Remov… <span style="color: #BB0000;">NA</span>          FALSE    batch Stre…</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 4</span> 518d5892601827e3880000c5 Street or Sidewalk… <span style="color: #BB0000;">NA</span>          TRUE     batch Stre…</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 5</span> 518d572e601827e388000058 Garbage Containers  Report an … TRUE     batch Stre…</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 6</span> 50fea92c4aa48a4a9e000099 Graffiti            Report bui… TRUE     batch Stre…</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 7</span> 50fea6d54aa48a4a9e00002e Illegal Postings    Report han… TRUE     batch Stre…</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 8</span> 518d564b601827e38800002d Blocked Pedestrian… <span style="color: #BB0000;">NA</span>          TRUE     batch Stre…</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 9</span> 55e8409a45ff461f92000006 Encampment          <span style="color: #BB0000;">NA</span>          TRUE     batch Stre…</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">10</span> 518d5d52601827e3880001b1 Abandoned Vehicles  Report a v… TRUE     batch Park…</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># ℹ 11 more rows</span></span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="requests">Requests<a class="anchor" aria-label="anchor" href="#requests"></a>
</h3>
<p>To get data about civic issues in the city area, run
<code>o311_requests</code>.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/o311_requests.html">o311_requests</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt; Simple feature collection with 50 features and 11 fields</span></span>
<span><span class="co">#&gt; Geometry type: POINT</span></span>
<span><span class="co">#&gt; Dimension:     XY</span></span>
<span><span class="co">#&gt; Bounding box:  xmin: -122.5111 ymin: 37.74945 xmax: -122.3949 ymax: 37.79207</span></span>
<span><span class="co">#&gt; Geodetic CRS:  WGS 84</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 50 × 12</span></span></span>
<span><span class="co">#&gt;    service_request_id status service_name               service_code description</span></span>
<span><span class="co">#&gt;    <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>              <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>                      <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>        <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>      </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 1</span> 1020140896         open   Abandoned Vehicles         518d5d52601… Grey Mazda…</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 2</span> 1020140726         open   Abandoned Vehicles         518d5d52601… test       </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 3</span> 1020140725         open   Park Requests              518d5cc9601… test       </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 4</span> 1020140302         open   Street or Sidewalk Cleani… 518d5892601… Test - gar…</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 5</span> 1020139578         open   Street or Sidewalk Cleani… 518d5892601… Garbage on…</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 6</span> 1020139514         open   Encampment                 55e8409a45f… <span style="color: #BB0000;">NA</span>         </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 7</span> 1020139513         closed Flooding, Sewer &amp; Water L… 518d5c0d601… -- TEST MA…</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 8</span> 1020139511         open   Shared Spaces              6050cd8ce89… <span style="color: #BB0000;">NA</span>         </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 9</span> 1020139507         open   Tree Maintenance           518d595d601… southbound…</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">10</span> 1020139506         open   Pothole &amp; Street Issues    50fea9c24aa… southbound…</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># ℹ 40 more rows</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># ℹ 7 more variables: requested_datetime &lt;chr&gt;, updated_datetime &lt;chr&gt;,</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;">#   address &lt;chr&gt;, token &lt;chr&gt;, status_notes &lt;chr&gt;, media_url &lt;chr&gt;,</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;">#   geometry &lt;POINT [°]&gt;</span></span></span></code></pre></div>
<p>Using the output of <code>o311_services</code>, you can further
narrow down the output of requests. Open311 defines a set of standard
parameters which are implemented by all endpoints. Using the
<code>service_code</code> parameter with one of the previously returned
service codes, only complaints about businesses illegally using shared
spaces are returned.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/o311_requests.html">o311_requests</a></span><span class="op">(</span>service_code <span class="op">=</span> <span class="st">"6050cd8ce8961bbfa32bcf2c"</span><span class="op">)</span></span>
<span><span class="co">#&gt; Simple feature collection with 50 features and 10 fields</span></span>
<span><span class="co">#&gt; Geometry type: POINT</span></span>
<span><span class="co">#&gt; Dimension:     XY</span></span>
<span><span class="co">#&gt; Bounding box:  xmin: -122.444 ymin: 37.75765 xmax: -122.3931 ymax: 37.79074</span></span>
<span><span class="co">#&gt; Geodetic CRS:  WGS 84</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 50 × 11</span></span></span>
<span><span class="co">#&gt;    service_request_id status service_name  service_code       requested_datetime</span></span>
<span><span class="co">#&gt;    <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>              <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>         <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>              <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>             </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 1</span> 1020139511         open   Shared Spaces 6050cd8ce8961bbfa… 2023-12-08T23:54:…</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 2</span> 6405413            closed Shared Spaces 6050cd8ce8961bbfa… 2016-10-11T13:17:…</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 3</span> 1020139479         open   Shared Spaces 6050cd8ce8961bbfa… 2023-12-05T22:52:…</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 4</span> 1020139460         open   Shared Spaces 6050cd8ce8961bbfa… 2023-12-01T17:20:…</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 5</span> 1020139449         open   Shared Spaces 6050cd8ce8961bbfa… 2023-11-29T23:30:…</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 6</span> 1020139418         open   Shared Spaces 6050cd8ce8961bbfa… 2023-11-27T18:53:…</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 7</span> 1020139417         open   Shared Spaces 6050cd8ce8961bbfa… 2023-11-27T18:43:…</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 8</span> 1020139414         open   Shared Spaces 6050cd8ce8961bbfa… 2023-11-27T18:31:…</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 9</span> 1020139411         open   Shared Spaces 6050cd8ce8961bbfa… 2023-11-27T18:23:…</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">10</span> 1020139392         open   Shared Spaces 6050cd8ce8961bbfa… 2023-11-17T02:14:…</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># ℹ 40 more rows</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># ℹ 6 more variables: updated_datetime &lt;chr&gt;, address &lt;chr&gt;, token &lt;chr&gt;,</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;">#   status_notes &lt;chr&gt;, description &lt;chr&gt;, geometry &lt;POINT [°]&gt;</span></span></span></code></pre></div>
<p>Similarly, using a <code>service_request_id</code> from the output,
you can retrieve a single service request from the API.</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/o311_requests.html">o311_request</a></span><span class="op">(</span><span class="st">"1020139511"</span><span class="op">)</span></span>
<span><span class="co">#&gt; Simple feature collection with 1 feature and 8 fields</span></span>
<span><span class="co">#&gt; Geometry type: POINT</span></span>
<span><span class="co">#&gt; Dimension:     XY</span></span>
<span><span class="co">#&gt; Bounding box:  xmin: -122.4183 ymin: 37.775 xmax: -122.4183 ymax: 37.775</span></span>
<span><span class="co">#&gt; Geodetic CRS:  WGS 84</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 1 × 9</span></span></span>
<span><span class="co">#&gt;   service_request_id status service_name  service_code        requested_datetime</span></span>
<span><span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>              <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>         <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>               <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>             </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span> 1020139511         open   Shared Spaces 6050cd8ce8961bbfa3… 2023-12-08T23:54:…</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># ℹ 4 more variables: updated_datetime &lt;chr&gt;, address &lt;chr&gt;, token &lt;chr&gt;,</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;">#   geometry &lt;POINT [°]&gt;</span></span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="bulk-queries">Bulk queries<a class="anchor" aria-label="anchor" href="#bulk-queries"></a>
</h3>
<p>Many endpoints define a page limit meaning that responses are divided
into pages. A query without parameters returns the first page.
Pagination can be controlled with the <code>page</code> argument. To
control pagination, the <code>o311_request_all</code> function can come
in handy. It automatically iterates through pages and heuristically
decides when to stop. The following example retrieves data from the
first two pages, resulting in a tibble with 100 service requests.</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/o311_requests.html">o311_request_all</a></span><span class="op">(</span>max_pages <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span>
<span><span class="co">#&gt; Simple feature collection with 100 features and 11 fields</span></span>
<span><span class="co">#&gt; Geometry type: POINT</span></span>
<span><span class="co">#&gt; Dimension:     XY</span></span>
<span><span class="co">#&gt; Bounding box:  xmin: -122.5111 ymin: 37.73277 xmax: -122.3931 ymax: 37.79207</span></span>
<span><span class="co">#&gt; Geodetic CRS:  WGS 84</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 100 × 12</span></span></span>
<span><span class="co">#&gt;    service_request_id status service_name               service_code description</span></span>
<span><span class="co">#&gt;    <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>              <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>                      <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>        <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>      </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 1</span> 1020140896         open   Abandoned Vehicles         518d5d52601… Grey Mazda…</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 2</span> 1020140726         open   Abandoned Vehicles         518d5d52601… test       </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 3</span> 1020140725         open   Park Requests              518d5cc9601… test       </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 4</span> 1020140302         open   Street or Sidewalk Cleani… 518d5892601… Test - gar…</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 5</span> 1020139578         open   Street or Sidewalk Cleani… 518d5892601… Garbage on…</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 6</span> 1020139514         open   Encampment                 55e8409a45f… <span style="color: #BB0000;">NA</span>         </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 7</span> 1020139513         closed Flooding, Sewer &amp; Water L… 518d5c0d601… -- TEST MA…</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 8</span> 1020139511         open   Shared Spaces              6050cd8ce89… <span style="color: #BB0000;">NA</span>         </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 9</span> 1020139507         open   Tree Maintenance           518d595d601… southbound…</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">10</span> 1020139506         open   Pothole &amp; Street Issues    50fea9c24aa… southbound…</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># ℹ 90 more rows</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># ℹ 7 more variables: requested_datetime &lt;chr&gt;, updated_datetime &lt;chr&gt;,</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;">#   address &lt;chr&gt;, token &lt;chr&gt;, status_notes &lt;chr&gt;, media_url &lt;chr&gt;,</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;">#   geometry &lt;POINT [°]&gt;</span></span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="non-standard-parameters">Non-standard parameters<a class="anchor" aria-label="anchor" href="#non-standard-parameters"></a>
</h3>
<p><code>r311</code> implicitly supports API extensions introducing
custom paths and parameters. One such API is Klarschiff Rostock which is
based on CitySDK. Klarschiff CitySDK defines a number of non-default
paths and parameters which extend the filtering abilities of open311
requests. Available parameters can usually be found in the respective
documentation (e.g. on GitHub for <a href="https://github.com/bfpi/klarschiff-citysdk" class="external-link">Klarschiff
CitySDK</a>). The following query returns the last 50 requests tagged
with the “idea” keyword.</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/o311_api.html">o311_api</a></span><span class="op">(</span><span class="st">"Rostock"</span><span class="op">)</span></span>
<span><span class="va">tickets</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/o311_requests.html">o311_requests</a></span><span class="op">(</span>keyword <span class="op">=</span> <span class="st">"idea"</span>, max_requests <span class="op">=</span> <span class="fl">50</span><span class="op">)</span></span></code></pre></div>
<p>Some custom parameters can also alter the shape of the output. In the
following example, we query just the count of total requests using the
<code>just_count</code> parameter. The result is a 1×1 tibble containing
a count value.</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/o311_requests.html">o311_requests</a></span><span class="op">(</span>just_count <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 1 × 1</span></span></span>
<span><span class="co">#&gt;   value</span></span>
<span><span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;int&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span>  <span style="text-decoration: underline;">4</span>260</span></span></code></pre></div>
<p>The CitySDK extensions also offers additional URL paths which can be
queried using the generic <code>o311_query</code> function.</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">poly</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/o311_query.html">o311_query</a></span><span class="op">(</span><span class="st">"areas"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">poly</span><span class="op">$</span><span class="va">grenze</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">tickets</span><span class="op">$</span><span class="va">geometry</span>, add <span class="op">=</span> <span class="cn">TRUE</span>, pch <span class="op">=</span> <span class="fl">16</span><span class="op">)</span></span></code></pre></div>
<p><img src="r311_files/figure-html/unnamed-chunk-14-1.png" width="700"></p>
</div>
</div>
<div class="section level2">
<h2 id="cleanup">Cleanup<a class="anchor" aria-label="anchor" href="#cleanup"></a>
</h2>
<p>Endpoint data is stored persistently between sessions so that you can
create your own database of open311 endpoints. This database is stored
in the system’s user directory as returned by
<code>tools::R_user_dir("r311")</code>. To reset the database, run</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/o311_endpoints.html">o311_reset_endpoints</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p>This will default back to the endpoints defined by <code>r311</code>
and remove all endpoints manually added by
<code>o311_add_endpoints</code>.</p>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Jonas Lieth.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.0.</p>
</div>

    </footer>
</div>





  </body>
</html>
