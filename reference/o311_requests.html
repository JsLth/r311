<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Get civic service request data — o311_requests • r311</title><!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png"><link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png"><link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png"><link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png"><link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png"><link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png"><script src="../katex-auto.js"></script><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/Roboto-0.4.9/font.css" rel="stylesheet"><link href="../deps/JetBrains_Mono-0.4.9/font.css" rel="stylesheet"><link href="../deps/Roboto_Slab-0.4.9/font.css" rel="stylesheet"><link href="../deps/font-awesome-6.4.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.4.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><link href="../deps/KaTex-0.16.10/katex.min.css" rel="stylesheet"><script src="../deps/KaTex-0.16.10/katex.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Get civic service request data — o311_requests"><meta name="description" content="Get civic service request data from a registered open311 endpoint.
o311_request queries a single service request by ID.
o311_requests queries a single page of service requests.
o311_request_all tries to iterate through all pages of an endpoint
to return a complete dataset of service requests."><meta property="og:description" content="Get civic service request data from a registered open311 endpoint.
o311_request queries a single service request by ID.
o311_requests queries a single page of service requests.
o311_request_all tries to iterate through all pages of an endpoint
to return a complete dataset of service requests."><meta property="og:image" content="https://ropengov.github.io/r311/logo.png"><meta name="twitter:card" content="summary_large_image"><meta name="twitter:creator" content="@rOpenGov"><meta name="twitter:site" content="@rOpenGov"><link rel="preconnect" href="https://fonts.googleapis.com"><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin><link href="https://fonts.googleapis.com/css2?family=B612+Mono:ital,wght@0,400;0,700;1,400;1,700&amp;family=Roboto+Mono:ital,wght@0,100..700;1,100..700&amp;display=swap" rel="stylesheet"><!-- rogtemplate style sheet --><link href="../BS5/rogtemplate.min.css" rel="stylesheet"></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-dark" data-bs-theme="dark" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">r311</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.4.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item"><a class="nav-link" href="../index.html"><span class="fa fa-home"></span> Overview</a></li>
<li class="nav-item"><a class="nav-link" href="../articles/r311.html"><span class="fa fa-book"></span> Get started</a></li>
<li class="active nav-item"><a class="nav-link" href="../reference/index.html"><span class="fa fa-search"></span> Reference</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/rOpenGov/r311/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Get civic service request data</h1>
      <small class="dont-index">Source: <a href="https://github.com/rOpenGov/r311/blob/main/R/requests.R" class="external-link"><code>R/requests.R</code></a></small>
      <div class="d-none name"><code>o311_requests.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Get civic service request data from a registered open311 endpoint.
<code>o311_request</code> queries a single service request by ID.
<code>o311_requests</code> queries a single page of service requests.
<code>o311_request_all</code> tries to iterate through all pages of an endpoint
to return a complete dataset of service requests.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">o311_requests</span><span class="op">(</span></span>
<span>  service_code <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  start_date <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  end_date <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  status <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  page <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  <span class="va">...</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu">o311_request</span><span class="op">(</span><span class="va">service_request_id</span>, <span class="va">...</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">o311_request_all</span><span class="op">(</span></span>
<span>  service_code <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  start_date <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  end_date <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  status <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  <span class="va">...</span>,</span>
<span>  max_pages <span class="op">=</span> <span class="cn">Inf</span>,</span>
<span>  progress <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-service-code">service_code<a class="anchor" aria-label="anchor" href="#arg-service-code"></a></dt>
<dd><p><code>[character]</code></p>
<p>IDs of the service types to be queried. Defaults to all available codes of
an endpoint. A list of all available service codes can be retrieved using
<code><a href="o311_services.html">o311_services</a></code>.</p></dd>


<dt id="arg-start-date-end-date">start_date, end_date<a class="anchor" aria-label="anchor" href="#arg-start-date-end-date"></a></dt>
<dd><p><code>[POSIXt]</code></p>
<p>Start date and end date of the query results. Must be date-time objects.
If not specified, defaults to the last 90 days.</p></dd>


<dt id="arg-status">status<a class="anchor" aria-label="anchor" href="#arg-status"></a></dt>
<dd><p><code>[character]</code></p>
<p>Status of the public service ticket. Can be one of <code>"open"</code> or
<code>"closed"</code>. If <code>NULL</code>, returns all types of tickets.</p></dd>


<dt id="arg-page">page<a class="anchor" aria-label="anchor" href="#arg-page"></a></dt>
<dd><p><code>[integer]</code></p>
<p>Page of the response. Most endpoints paginate their responses in a way
that only a limited number of tickets are returned with each query.
To retrieve all data, consider using <code>o311_request_all</code>.</p></dd>


<dt id="arg--">...<a class="anchor" aria-label="anchor" href="#arg--"></a></dt>
<dd><p>Further endpoint-specific parameters as documented in the
respective endpoint reference.</p></dd>


<dt id="arg-service-request-id">service_request_id<a class="anchor" aria-label="anchor" href="#arg-service-request-id"></a></dt>
<dd><p><code>[character]</code></p>
<p>Identifier of a single service request. Request IDs can usually be retrieved
from <code>o311_requests</code>.</p></dd>


<dt id="arg-max-pages">max_pages<a class="anchor" aria-label="anchor" href="#arg-max-pages"></a></dt>
<dd><p><code>[integer]</code></p>
<p>Number of pages to search until the result is returned.</p></dd>


<dt id="arg-progress">progress<a class="anchor" aria-label="anchor" href="#arg-progress"></a></dt>
<dd><p><code>[logical]</code></p>
<p>Whether to show a waiter indicating the current page iteration.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>A dataframe containing data on civic service requests. The
dataframe can contain varying columns depending on the open311
implementation.</p>
    </div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p><code>o311_request_all</code> applies a number of checks to determine when to
stop searching. First, many endpoints return an error if the last page
is exceeded. Thus, if the last page request failed, break.
Second, if exceeding the pagination limit does not return an error, the
response is compared with the previous response. If identical, the
response is discarded and all previous responses returned. Finally,
if the page exceeds <code>max_pages</code>, the responses up to this point are
returned.</p>
<p>open311 leaves space for endpoints to implement their own request
parameters. These parameters can be provided using dot arguments.
These arguments are not validated or pre-processed. Date-time objects
must be formatted according to the
<a href="https://www.w3.org/TR/NOTE-datetime" class="external-link">w3c</a> standard.
Some more common parameters include:</p>
<ul><li><p><code>q</code>: Perform a text search across all requests.</p></li>
<li><p><code>update_after</code>/<code>updated_before</code>: Limit request according
 to request update dates.</p></li>
<li><p><code>per_page</code>: Specifiy the maximum number of requests per page.</p></li>
<li><p><code>extensions</code>: Adds a nested attribute
 <code>"extended_attributes"</code> to the response.</p></li>
<li><p><code>long</code>/<code>lat</code>/<code>radius</code>: Searches for requests in a fixed radius
 around a coordinate.</p></li>
</ul><p>As dot arguments deviate from the open311 standard, they are not guaranteed
to be available for every endpoint and might be removed without further
notice. Refer to the endpoint docs to learn more about custom parameters
(<code>o311_endpoints()$docs</code>).</p>
    </div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p><code><a href="o311_api.html">o311_api</a></code></p></div>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="fu"><a href="o311_api.html">o311_api</a></span><span class="op">(</span><span class="st">"zurich"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="co"># \donttest{</span></span></span>
<span class="r-in"><span><span class="kw">if</span> <span class="op">(</span><span class="fu"><a href="o311_ok.html">o311_ok</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span></span>
<span class="r-in"><span>  <span class="co"># retrieve requests from the last two days</span></span></span>
<span class="r-in"><span>  <span class="va">now</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Sys.time.html" class="external-link">Sys.time</a></span><span class="op">(</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="va">two_days</span> <span class="op">&lt;-</span> <span class="fl">60</span> <span class="op">*</span> <span class="fl">60</span> <span class="op">*</span> <span class="fl">24</span> <span class="op">*</span> <span class="fl">2</span></span></span>
<span class="r-in"><span>  <span class="fu">o311_requests</span><span class="op">(</span>end_date <span class="op">=</span> <span class="va">now</span>, start_date <span class="op">=</span> <span class="va">now</span> <span class="op">-</span> <span class="va">two_days</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="co"># retrieve only open tickets</span></span></span>
<span class="r-in"><span>  <span class="va">tickets</span> <span class="op">&lt;-</span> <span class="fu">o311_requests</span><span class="op">(</span>status <span class="op">=</span> <span class="st">"open"</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="co"># request the first ticket of the previous response</span></span></span>
<span class="r-in"><span>  <span class="va">rid</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/character.html" class="external-link">as.character</a></span><span class="op">(</span><span class="va">tickets</span><span class="op">$</span><span class="va">service_request_id</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="fu">o311_request</span><span class="op">(</span><span class="va">rid</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="kw">if</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/interactive.html" class="external-link">interactive</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span></span>
<span class="r-in"><span>    <span class="co"># request all data</span></span></span>
<span class="r-in"><span>    <span class="fu">o311_request_all</span><span class="op">(</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="op">}</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="co"># request data of the first 5 pages</span></span></span>
<span class="r-in"><span>  <span class="fu">o311_request_all</span><span class="op">(</span>max_pages <span class="op">=</span> <span class="fl">5</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">}</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Simple feature collection with 1000 features and 13 fields</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Geometry type: POINT</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Dimension:     XY</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Bounding box:  xmin: 8.471601 ymin: 47.32494 xmax: 8.598776 ymax: 47.43136</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Geodetic CRS:  WGS 84</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;"># A tibble: 1,000 × 14</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    service_code              updated_datetime     description requested_datetime</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>                     <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>                <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>       <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>             </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 1</span> Brunnen/Hydranten         2024-10-30T14:00:23… <span style="color: #949494;">"</span>Wasser lä… 2024-10-30T12:16:…</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 2</span> Beleuchtung/Uhren         2024-10-30T11:54:51… <span style="color: #949494;">"</span>Abdeckung… 2024-10-30T12:28:…</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 3</span> Beleuchtung/Uhren         2024-10-30T11:53:55… <span style="color: #949494;">"</span>Hegianwan… 2024-10-30T12:22:…</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 4</span> Abfall/Sammelstelle       2024-10-30T11:02:05… <span style="color: #949494;">"</span>Abfall: D… 2024-10-30T10:50:…</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 5</span> Abfall/Sammelstelle       2024-10-30T11:02:05… <span style="color: #949494;">"</span>Viel Abfa… 2024-10-30T10:47:…</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 6</span> Abfall/Sammelstelle       2024-10-30T13:56:03… <span style="color: #949494;">"</span>Reinigung… 2024-10-30T10:33:…</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 7</span> Abfall/Sammelstelle       2024-10-30T13:57:57… <span style="color: #949494;">"</span>MöbelStüc… 2024-10-30T08:39:…</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 8</span> Signalisation/Lichtsignal 2024-10-30T07:32:04… <span style="color: #949494;">"</span>Fussgänge… 2024-10-30T07:24:…</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 9</span> VBZ/ÖV                    2024-10-30T13:52:38… <span style="color: #949494;">"</span>Guten mor… 2024-10-30T09:02:…</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">10</span> Signalisation/Lichtsignal 2024-10-30T14:00:43… <span style="color: #949494;">"</span>An der Am… 2024-10-30T05:55:…</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;"># ℹ 990 more rows</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;"># ℹ 10 more variables: agency_sent_datetime &lt;chr&gt;, service_name &lt;chr&gt;,</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;">#   detail &lt;chr&gt;, service_notice &lt;chr&gt;, title &lt;chr&gt;, status &lt;chr&gt;,</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;">#   service_request_id &lt;int&gt;, interface_used &lt;chr&gt;, media_url &lt;chr&gt;,</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;">#   geometry &lt;POINT [°]&gt;</span></span>
<span class="r-in"><span><span class="co"># }</span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Jonas Lieth.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

    </footer></div>



    <!-- Add ropengov logo -->
  <script src="../BS5/logo.js"></script></body></html>

